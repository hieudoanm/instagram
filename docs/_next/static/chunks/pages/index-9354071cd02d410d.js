(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7661:(t,e,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(3875)}])},3875:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>p});var i=s(612),r=s(4344),n=s(7812),a=s(2655),o=s(294),u=s(7902),c=class extends o.Q{#t;#e=void 0;#s;#i;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,u.f8)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,u.EN)(e.mutationKey)!==(0,u.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#r(),this.#n(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#r(),this.#n()}mutate(t,e){return this.#i=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#r(){let t=this.#s?.state??(0,n.$)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#n(t){a.j.batch(()=>{if(this.#i&&this.hasListeners()){let e=this.#e.variables,s=this.#e.context;t?.type==="success"?(this.#i.onSuccess?.(t.data,e,s),this.#i.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#i.onError?.(t.error,e,s),this.#i.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#e)})})}},l=s(829);function h(){}let d=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"downloaded-image.jpg",s=await fetch(t).then(t=>t.blob()),i=document.createElement("a");i.href=URL.createObjectURL(s),i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(i.href)},p=()=>{let[{url:t,images:e},s]=(0,r.useState)({url:"https://www.instagram.com/p/DFijU7Gzkae",images:[]}),n=function(t,e){var s,i;let n=(0,l.jE)(void 0),[o]=r.useState(()=>new c(n,t));r.useEffect(()=>{o.setOptions(t)},[o,t]);let u=r.useSyncExternalStore(r.useCallback(t=>o.subscribe(a.j.batchCalls(t)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),d=r.useCallback((t,e)=>{o.mutate(t,e).catch(h)},[o]);if(u.error&&(s=o.options.throwOnError,i=[u.error],"function"==typeof s?s(...i):!!s))throw u.error;return{...u,mutate:d,mutateAsync:u.mutate}}({mutationFn:t=>fetch("http://localhost:8080/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})}).then(async t=>t.json())});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("nav",{className:"border-b border-gray-300",children:(0,i.jsx)("div",{className:"container mx-auto p-4",children:(0,i.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,i.jsx)("h1",{className:"text-xl",children:"Instagram"}),(0,i.jsxs)("form",{className:"flex grow items-center overflow-hidden rounded border border-black border-gray-300",onSubmit:async e=>{e.preventDefault(),s(t=>({...t,images:[]}));let{images:i}=await n.mutateAsync(t);s(t=>({...t,images:i}))},children:[(0,i.jsx)("input",{id:"url",name:"url",placeholder:"URL",className:"grow px-2 py-1",value:t,onChange:t=>s(e=>({...e,url:t.target.value})),required:!0}),(0,i.jsx)("button",{type:"submit",className:"h-full w-16 bg-gray-300 px-2 py-1 text-black",children:"Query"})]})]})})}),(0,i.jsx)("main",{children:(0,i.jsxs)("div",{className:"container mx-auto p-4",children:[n.isPending&&(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-center",children:"Loading"})}),e.length>0&&(0,i.jsx)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6",children:e.map(t=>(0,i.jsxs)("div",{className:"col-span-1 flex flex-col gap-y-1 overflow-hidden rounded border border-gray-300 p-1",children:[(0,i.jsx)("div",{className:"aspect-square w-full rounded bg-contain bg-center bg-no-repeat",style:{backgroundImage:"url(".concat(t,")")}}),(0,i.jsx)("button",{type:"button",className:"w-full rounded bg-black py-1 text-sm text-white",onClick:()=>{d(t)},children:"Download"})]},t))})]})})]})}}},t=>{var e=e=>t(t.s=e);t.O(0,[636,593,792],()=>e(7661)),_N_E=t.O()}]);